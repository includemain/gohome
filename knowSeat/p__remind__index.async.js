"use strict";(self.webpackChunksub_know_seat=self.webpackChunksub_know_seat||[]).push([[399],{25637:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var a=n(17662),o=n.n(a),r=n(31404),c=n.n(r),i=n(35118),l=n.n(i),s=n(34944),u=n.n(s),d=n(17925),m=n.n(d),f=n(4143),h=n.n(f),p=(n(23279),n(16769),n(48239),n(80348),n(25506),n(8532),n(14748)),v=n(48493),x=n(62365),g=n(82405),k=n(81884),A=n(6889),w=n(27778),D=n(4843),b=n(22944),j=n(89444),S=n(978),Y=n(73287),_=n(57065),I=n.n(_),T={remind:"remind___ujXFN",tableBtnsUnable:"tableBtnsUnable___Ajcls",modalLose:"modalLose___ApbsB",radioGroupBox:"radioGroupBox___v9ieW",treeSelectSelector:"treeSelectSelector___vVbYd"},M=n(84871),Z=n(42224),R=n(55375),C=n(50107),H=p.Z.TextArea,N=(v.Z.RangePicker,"0wZd"),G={labelCol:{span:5},wrapperCol:{span:19}},y=function(e){return e.notReleased="notReleased",e.released="released",e.takenDown="takenDown",e}(y||{}),P=h()(h()(h()({},y.notReleased,"未发布"),y.released,"已发布"),y.takenDown,"已下架"),q=h()(h()(h()({},y.notReleased,"blue-color"),y.released,"green-color"),y.takenDown,"gray-color"),U=function(){var e,t,a=(0,S.useRef)(),r=x.Z.useForm(),i=m()(r,1)[0],s=(0,S.useRef)(null),d=(0,S.useState)(!1),f=m()(d,2),h=f[0],_=f[1],y=(0,S.useState)(null),U=m()(y,2),B=U[0],E=U[1],W=(0,S.useState)(!1),X=m()(W,2),F=(X[0],X[1],(0,S.useState)()),Q=m()(F,2),z=Q[0],J=Q[1],L=(0,S.useState)(!1),O=m()(L,2),V=O[0],K=O[1],$=(0,S.useState)(!1),ee=m()($,2),te=ee[0],ne=ee[1],ae=(0,S.useState)(),oe=m()(ae,2),re=oe[0],ce=oe[1],ie=(0,S.useState)(""),le=m()(ie,2),se=(le[0],le[1]),ue=(0,S.useState)(""),de=m()(ue,2),me=(de[0],de[1]),fe=(0,S.useState)(""),he=m()(fe,2),pe=he[0],ve=he[1],xe=(0,S.useState)(""),ge=m()(xe,2),ke=(ge[0],ge[1]),Ae=(0,S.useState)(""),we=m()(Ae,2),De=(we[0],we[1]),be=(0,S.useState)(""),je=m()(be,2),Se=(je[0],je[1],(0,S.useState)("")),Ye=m()(Se,2),_e=Ye[0],Ie=Ye[1],Te=(0,S.useState)(""),Me=m()(Te,2),Ze=Me[0],Re=Me[1],Ce=(0,S.useState)(""),He=m()(Ce,2),Ne=He[0],Ge=He[1],ye=(0,S.useRef)([]),Pe=(0,S.useRef)([]),qe=(0,S.useRef)(),Ue=function(e){return e&&e<I()().startOf("day")},Be=new Date,Ee=new Date(Be);Ee.setDate(Be.getDate()+1);var We=Ee.getTime();(0,S.useEffect)((function(){Xe(),(0,Z.Ym)().then((function(e){var t=[];t.push(null==e?void 0:e.data),Fe(t,"value","title","children")}))}),[]);var Xe=function(){(0,Z.sM)().then((function(e){var t=[];null==e||e.data.forEach((function(e){var n={value:e.username,text:e.name};t.push(n)})),Ge(t)})).catch((function(e){}))},Fe=function(e,t,n,a){if("object"===u()(e)&&null!==e){for(var o in e)"accountGroupId"==o&&(e[t]=e.accountGroupId,delete e.accountGroupId),"accountGroupName"==o&&(e[n]=e.accountGroupName,delete e.accountGroupName),"childNodes"==o&&(e[a]=e.childNodes,delete e.childNodes);for(var r in e)e[r]&&"object"===u()(e[r])&&Fe(e[r],t,n,a);ce(e)}},Qe=function(e){"notReleased"==(null==e?void 0:e.status)?Ie("notReleased"):"released"==(null==e?void 0:e.status)&&Ie("released"),ne(!0),J("edit"),Re(null==e?void 0:e.noticeId),(0,Z.rh)({noticeId:null==e?void 0:e.noticeId}).then((function(t){var n,a,o,r,c,l;qe.current=null==t||null===(n=t.data)||void 0===n?void 0:n.updateTime,Pe.current=null==t||null===(a=t.data)||void 0===a?void 0:a.accountGroupNames,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",n=[],a=function(e){n.push(e),e[t]&&e[t].length>0&&e[t].forEach((function(e){return a(e)}))};e.forEach((function(e){return a(e)}));var o=[];null==n||n.forEach((function(e){Pe.current.includes(e.title)&&o.push(e.value)})),ye.current=o}(re),i.setFieldsValue({title:null==t||null===(o=t.data)||void 0===o?void 0:o.title,content:null==t||null===(r=t.data)||void 0===r?void 0:r.content,momentTime:I()((0,M.MJ)(null==t||null===(c=t.data)||void 0===c?void 0:c.startTime),"YYYY-MM-DD hh:mm"),endTime:I()((0,M.MJ)(null==t||null===(l=t.data)||void 0===l?void 0:l.endTime),"YYYY-MM-DD hh:mm"),accountGroupIds:ye.current,startTime:"notReleased"==(null==e?void 0:e.status)?"立即发布":"预约发布"})})),ve("预约发布")},ze=[{width:180,dataIndex:"title",title:"重要事项名称"},{width:150,dataIndex:"accountGroupNames",title:"通知部门",render:function(e,t){return e.map((function(t,n){return(0,C.jsxs)("span",{_nk:"iAr".concat(N,"11"),children:[(0,C.jsx)("span",{_nk:"".concat(N,"12"),children:t}),n!=e.length-1?(0,C.jsx)("span",{_nk:"".concat(N,"13"),children:"、"}):""]})}))}},{width:350,dataIndex:"content",title:"具体内容"},{width:80,dataIndex:"status",title:"提醒状态",filterMultiple:!1,filters:[{text:"未发布",value:"notReleased"},{text:"已发布",value:"released"},{text:"已下架",value:"takenDown"}],render:function(e){return(0,C.jsx)("div",{className:q[e],_nk:"".concat(N,"21"),children:P[e]})}},{width:80,dataIndex:"createUser",title:"创建人",filterMultiple:!1,filters:Ne,filterSearch:function(e,t){return n=e,o=[],r=[],null==(a=t)||a.map((function(e){var t={};t.text=e.title,t.value=e.key,o.push(t)})),0==n.length?o:(null==o||o.map((function(e){(e.value.includes(n)||e.text.includes(n))&&r.push(e)})),r);var n,a,o,r}},{width:120,dataIndex:"startTime",title:"发布时间",sorter:!0,render:function(e){return I()(e).format("YYYY-MM-DD HH:mm")}},{width:120,dataIndex:"endTime",title:"下架时间",sorter:!0,render:function(e){return I()(e).format("YYYY-MM-DD HH:mm")}},{dataIndex:"option",width:80,title:"操作",render:function(e,t,n){return(0,C.jsx)("div",{className:"table-btns",_nk:"".concat(N,"22"),children:(0,C.jsxs)(k.Z,{_nk:"".concat(N,"31"),children:["takenDown"==(null==t?void 0:t.status)?(0,C.jsx)(A.Z,{type:"link",className:"ant-btn ant-btn-unclick",_nk:"".concat(N,"41"),children:"编辑"}):(0,C.jsx)(A.Z,{type:"link",className:"ant-btn",onClick:function(){return Qe(t)},_nk:"".concat(N,"42"),children:"编辑"}),"released"==(null==t?void 0:t.status)?(0,C.jsx)(A.Z,{type:"link",className:"ant-btn",onClick:function(){return function(e){Re(null==e?void 0:e.noticeId),K(!0)}(t)},_nk:"".concat(N,"43"),children:"下架"}):(0,C.jsx)(A.Z,{type:"link",className:"ant-btn ant-btn-unclick",_nk:"".concat(N,"44"),children:"下架"})]})})}}],Je=function(){var e=c()(o()().mark((function e(t){var n;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:_(!0),n=l()({},t),t.accountGroupIds&&(n.accountGroupIds=[t.accountGroupIds]),t.createUser&&(n.username=t.createUser),t.startTime||t.endTime?n.sorting={field:t.startTime?"startTime":"endTime",order:"ascend"===t.startTime||"ascend"===t.endTime?"ascending":"descending"}:n.sorting={field:"",order:""},t.title&&(n.keyword=t.title),t.status?n.noticeStatus=t.status:n.noticeStatus="",(0,Z.s)(l()({},n)).then((function(e){_(!1),"0000"===(null==e?void 0:e.code)?E((null==e?void 0:e.data)||{list:[],count:0}):g.ZP.error((null==e?void 0:e.message)||"服务异常")})).catch((function(e){_(!1)}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=void 0===R.o.yx?"calc(100vh - 110px)":"100vh",Oe=(null===(e=s.current)||void 0===e?void 0:e.offsetHeight)||360,Ve=null===(t=s.current)||void 0===t?void 0:t.querySelector(".table-header-box"),Ke=null!=Ve&&Ve.offsetHeight?(null==Ve?void 0:Ve.offsetHeight)+68:0;return(0,C.jsxs)(w.ZP,{autoInsertSpaceInButton:!1,_nk:"".concat(N,"51"),children:[(0,C.jsx)("div",{ref:s,className:T.remind,style:{height:Le},_nk:"".concat(N,"23"),children:(0,C.jsx)(Y.Z,{ref:a,columns:ze,loading:h,total:(null==B?void 0:B.count)||0,dataSource:(null==B?void 0:B.list)||[],getData:function(e){return Je(e)},formChildren:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.Z.Item,{label:"重要事项名称",name:"keyword",_nk:"".concat(N,"71"),children:(0,C.jsx)(p.Z,{placeholder:"请输入",style:{minWidth:240,width:240},_nk:"".concat(N,"81")})}),(0,C.jsx)(x.Z.Item,{label:"通知部门",name:"accountGroupIds",_nk:"".concat(N,"72"),children:(0,C.jsx)(D.Z,{style:{borderRadius:8},value:1,dropdownStyle:{borderRadius:8},placeholder:"请选择",allowClear:!0,treeDefaultExpandAll:!0,onChange:function(){},treeData:re,dropdownMatchSelectWidth:!1,_nk:"".concat(N,"91")})})]}),extra:(0,C.jsx)(k.Z,{_nk:"".concat(N,"32"),children:(0,C.jsx)(A.Z,{className:"extra-btn",onClick:c()(o()().mark((function e(){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ne(!0),J("add"),i.resetFields(),Ie("");case 4:case"end":return e.stop()}}),e)}))),style:{color:"#fff"},_nk:"".concat(N,"45"),children:"新建提醒"})}),paginationMap:{current:"page"},scroll:{x:1300,y:Oe-Ke-98},_nk:"".concat(N,"61")})}),(0,C.jsx)(b.Z,{title:"add"==z?"新建提醒":"编辑提醒",width:560,className:"own-modal",height:505,destroyOnClose:!0,onOk:function(){i.validateFields().then((function(){var e,t=i.getFieldsValue();if("notReleased"==_e||"released"==_e){var n={title:null==t?void 0:t.title,content:null==t?void 0:t.content,startTime:"立即发布"==pe?(new Date).getTime():new Date(I()(null==t?void 0:t.momentTime).format("YYYY-MM-DD HH:mm")).getTime(),endTime:new Date(I()(null==t?void 0:t.endTime).format("YYYY-MM-DD HH:mm")).getTime(),accountGroupIds:null==t?void 0:t.accountGroupIds,noticeId:Ze,status:_e,updateTime:qe.current};(0,Z.UD)(l()({},n)).then((function(e){}))}else{var o={title:null==t?void 0:t.title,content:null==t?void 0:t.content,startTime:"立即发布"==pe?(new Date).getTime():new Date(I()(null==t?void 0:t.momentTime).format("YYYY-MM-DD HH:mm")).getTime(),endTime:new Date(I()(null==t?void 0:t.endTime).format("YYYY-MM-DD HH:mm")).getTime(),accountGroupIds:null==t?void 0:t.accountGroupIds};(0,Z.eP)(l()({},o)).then((function(e){"0000"==(null==e?void 0:e.code)?g.ZP.success("添加成功"):g.ZP.error((null==e?void 0:e.message)||"服务异常")})).catch((function(e){_(!1)}))}ye.current=[],ne(!1),_(!0),Je({page:1,pageSize:10,sorting:{field:"",order:""},noticeStatus:""}),null===(e=a.current)||void 0===e||e.setPaginationParams({current:1,pageSize:10}),ve("")}))},onCancel:function(){ne(!1),i.resetFields(),ye.current=[],ve("")},open:te,okText:"保存",cancelText:"关闭",_nk:"".concat(N,"a1"),children:(0,C.jsx)("div",{className:T.modalInfo,_nk:"".concat(N,"24"),children:(0,C.jsxs)(x.Z,l()(l()({className:"form-edit",form:i},G),{},{initialValues:{accountGroupIds:ye.current,endTime:I()("".concat((0,M.rr)(We)," 23:59"),"YYYY-MM-DD hh:mm"),momentTime:I()("".concat((0,M.rr)(We)," 00:00"),"YYYY-MM-DD hh:mm")},_nk:"".concat(N,"b1"),children:[(0,C.jsx)(x.Z.Item,{label:"重要事项名称",name:"title",className:"form-info-item",rules:[{required:!0,max:50}],_nk:"".concat(N,"73"),children:(0,C.jsx)(p.Z,{style:{borderRadius:8},showCount:!0,onChange:function(e){se(e.target.value)},placeholder:"请输入",disabled:"released"==_e,maxLength:50,_nk:"".concat(N,"82")})}),(0,C.jsx)(x.Z.Item,{label:"具体内容",name:"content",className:"form-info-item",rules:[{required:!0,max:500}],_nk:"".concat(N,"74"),children:(0,C.jsx)(H,{style:{borderRadius:8},showCount:!0,maxLength:500,rows:4,disabled:"released"==_e,autoSize:{minRows:4,maxRows:4},onChange:function(e){me(e.target.value)},placeholder:"请输入",_nk:"".concat(N,"c1")})}),(0,C.jsx)(x.Z.Item,{label:"发布时间",name:"startTime",className:"form-info-item",rules:[{required:!0,message:"请选择发布时间"}],_nk:"".concat(N,"75"),children:(0,C.jsxs)("div",{className:T.radioGroupBox,_nk:"".concat(N,"25"),children:[(0,C.jsxs)(j.ZP.Group,{onChange:function(e){ve(e.target.value)},value:pe,disabled:"released"==_e,_nk:"".concat(N,"76"),children:[(0,C.jsx)(j.ZP,{value:"立即发布",_nk:"".concat(N,"d1"),children:"立即发布"}),(0,C.jsx)(j.ZP,{value:"预约发布",_nk:"".concat(N,"d2"),children:"预约发布"})]}),"预约发布"==pe&&(0,C.jsx)(x.Z.Item,{name:"momentTime",rules:[{required:!0,message:"请选择发布时间"}],style:{marginBottom:0},_nk:"".concat(N,"77"),children:(0,C.jsx)(v.Z,{showTime:{format:"HH:mm"},disabledDate:Ue,style:{borderRadius:8},disabled:"released"==_e,onChange:function(e,t){ke(t)},_nk:"".concat(N,"e1")})})]})}),(0,C.jsx)(x.Z.Item,{label:"下架时间",name:"endTime",className:"form-info-item",rules:[{required:!0,message:"请选择下架时间"}],_nk:"".concat(N,"78"),children:(0,C.jsx)(v.Z,{disabledDate:Ue,showTime:{format:"HH:mm"},style:{borderRadius:8},onChange:function(e,t){De(t)},_nk:"".concat(N,"e2")})}),(0,C.jsx)(x.Z.Item,{label:"通知部门",name:"accountGroupIds",className:"form-info-item",rules:[{required:!0,message:"请选择通知部门"}],_nk:"".concat(N,"79"),children:(0,C.jsx)(D.Z,{treeCheckable:!0,className:T.treeSelectSelector,dropdownStyle:{borderRadius:8},placeholder:"请选择",allowClear:!0,multiple:!0,treeDefaultExpandAll:!0,onChange:function(){},treeData:re,disabled:"released"==_e,showArrow:!0,dropdownMatchSelectWidth:!1,_nk:"".concat(N,"92")})})]}))})}),(0,C.jsx)(b.Z,{width:300,height:144,onOk:function(){(0,Z.Kr)({noticeId:Ze}).then((function(e){var t;"0000"==(null==e?void 0:e.code)?(g.ZP.success("下架成功"),Je({page:1,pageSize:10,sorting:{field:"",order:""},noticeStatus:""}),null===(t=a.current)||void 0===t||t.setPaginationParams({curent:1,pageSize:10})):g.ZP.error(null==e?void 0:e.msg)})).catch((function(e){})),K(!1)},onCancel:function(){K(!1)},open:V,className:"modal-table-detail",closable:!1,_nk:"".concat(N,"a2"),children:(0,C.jsxs)("div",{className:T.modalLose,_nk:"".concat(N,"26"),children:[(0,C.jsx)("img",{className:"icon",src:n(30716),_nk:"".concat(N,"f1")}),(0,C.jsx)("div",{className:"modal-title",_nk:"".concat(N,"27"),children:"确认下架？"})]})})]})}},42224:function(e,t,n){n.d(t,{Kr:function(){return s},UD:function(){return l},Ym:function(){return u},bb:function(){return h},eP:function(){return i},rh:function(){return m},s:function(){return c},sM:function(){return d},zI:function(){return f}});var a=n(35118),o=n.n(a),r=n(92938);function c(e){return(0,r.request)("/rest/csoip/notice/query",{method:"post",data:o()(o()({},e),{},{page:(null==e?void 0:e.page)-1})})}function i(e){return(0,r.request)("/rest/csoip/notice/add",{method:"post",data:o()({},e)})}function l(e){return(0,r.request)("/rest/csoip/notice/update",{method:"post",data:o()({},e)})}function s(e){return(0,r.request)("/rest/csoip/notice/take-off",{method:"post",data:o()({},e)})}function u(){return(0,r.request)("/rest/csoip/notice/account-groups",{method:"post"})}function d(){return(0,r.request)("/rest/csoip/notice/user-groups",{method:"post"})}function m(e){return(0,r.request)("/rest/csoip/notice/update/query",{method:"post",data:o()({},e)})}function f(){return(0,r.request)("/rest/csoip/notice/list",{method:"post"})}function h(e){return(0,r.request)("/rest/csoip/notice/touch",{method:"post",data:o()({},e)})}},30716:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAAXNSR0IArs4c6QAABAJJREFUaEPdml1oFFcUx//nzswmQtUak00Viu1Li6JS0Coa+xDqg0irxKRbRR9EseKD5L0orii+iw+lBEvBFtvoKtoifVBSkLYoaREVxb7UIBh2E1M/AsadufeUO2Zlk93Jzu7clZ3O4+6dc8/vnnPuPefcIcT8oZjrD+MAPLjCwfDw3AmWs4llQi8Qk5VvJusZFix4Qiv/dE0umhEA7l+S8OjRR7DVGij1AYNaAMwG4AMAyAN4RuAxCHEDnvjD5vlXKXVH/x7pqRmAL7XM8VyxgiTtYOATZk5WowkR5Qj4mYlP2U3qL9o49rSa9wtjawJ4cTa5XAhOM/NaAO21TFz0TpaIflcWpZs2525WK6sqAD7XnpRKHlaEHQDeqHayCuPHBeM7S1iHaEs2F1Z2aIDnF9vftTx5DIzPAfPBP6kwg/CjtK0vZ23K/hMGoiIAD8D2xpKrGep7AIvCCDUwZoggttstuWvUCW8meRUB3Eyyg4n7wLzYgGLhRRDuEIsvnO7cbzUD+G7jyoHXuPLTdR2SjtU5kzsFWkAHrAt5HIyt4ZetDiMJPziweoMCOxDAO9v6lSLsrWPAhqVlwfja7hndV+6FsgB6nydS2vdq3yoJ1xniFz0pQW0AY1VYjcuMG2cWHU09pedECYB/wk5Y3zJzV4QJQRCHne5cWstwM8k0Qx2KJI/ovN0sd04/sUsA3AutnezhdNQT1jQAgCwJbHW6Rn8tXogSAO9c20nFvCvKar10G7MW0DIF0Tf2lpHdgQB+VmmPPKg2MSsfXOYBdAJoe21vF2exUyzgnmn/mIW8HHX162UBX66y1jufZa8UdJwKcL7tACs+0tAAgg46XSNHSwB0JeUN3T/NoO6GBgBn7EXvbCtUdq8swD8tbHXz+X4AnY0MAGDASSRS9OnD0ZeuOvlM5j0aYGWDAwxKx0oV8qNXABMXWt8XHjTA8gYHuKlspJo3j96bYoHYA8TehUwHsSDRJ5U4rs1sCdWrWO0x4ZqBQWx6GwXwGISHvtKMhQDeNAFAQduonzUaPMhMKFs2RQk6yHwAg6lE3QBmSiVMJnNC0AkL5MeABPcqxfujQlVM5vQEhtLpnCPle5T694kfAv3z5rqW9TeAqtqP04ErptO+GxkpaOh2ontkWbEC+UzbLYCXRrBCuILGUEn5AuysS/QMD2qF85m3PgS8qwCaagWgsCWlnsBIUQ96BMGXfIUVbQR4fq3KAxhnW3SUa/7+P9sqfuDFvbGlIWLdWiz4q9/cheoD8Jqbu3SXmPZEau76rhT39nrBErG94Cje+mJ9xVQMUpdLPkXpcs3bSmdHxRuaIAGxvmadDhXLi+5Ay8TxU4NKflrP/2uOgXoqVY3s/wB1G19Plr/7iAAAAABJRU5ErkJggg=="}}]);
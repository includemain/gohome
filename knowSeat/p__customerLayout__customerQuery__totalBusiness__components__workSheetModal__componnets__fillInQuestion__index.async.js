(self.webpackChunksub_know_seat=self.webpackChunksub_know_seat||[]).push([[214],{21312:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return A}});var i=t(17662),o=t.n(i),r=t(35118),u=t.n(r),s=t(31404),l=t.n(s),c=t(17925),a=t.n(c),d=(t(16769),t(96751),t(29471),t(62365)),v=t(82405),f=t(41114),m=t(37244),p=t(14748),h=t(48493),x=t(6889),g=t(978),w="fillQuestionForm___djJ18",k=t(86013),j=t(92938),_=t(57065),q=t.n(_),Z=t(3518),I=t(50107),y="/S+g",A=function(){var n,e=(0,g.useState)(null),t=a()(e,2),i=t[0],r=t[1],s=(0,j.useSearchParams)(),c=a()(s,2),_=c[0],A=(c[1],_.get("questionId")||"");(0,g.useEffect)((function(){var n=sessionStorage.getItem(A)||"{}",e=JSON.parse(n);r(e)}),[]);var b=d.Z.useForm(),N=a()(b,1)[0],C=i||{},T=C.questionInfo,F=C.userInfo,P=void 0===F?{}:F,S=C.fundAccId,L=void 0===S?"":S,O=C.seatName,U=void 0===O?"":O,E=P.customerId,M=void 0===E?"":E,V=P.customerName,G=void 0===V?"":V,J=P.customerAge,Q=P.customerMobile,z=(0,g.useState)([]),Y=a()(z,2),B=(Y[0],Y[1]),D=(0,g.useState)(!1),H=a()(D,2),K=H[0],R=H[1],W=function(){N.setFieldsValue({submitTime:q()()}),N.resetFields(),B([])};(0,g.useEffect)((function(){W(),N.setFieldsValue({seatName:U,customerName:G,fundAccountId:L,customerAge:J,customerMobile:Q,startTime:q()()})}),[]);var X=function(){var n=l()(o()().mark((function n(){var e,t,i;return o()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,N.validateFields();case 2:if(e=n.sent,(t=Object.values((null==e?void 0:e.answers)||{})||[]).length){n.next=7;break}return v.ZP.error("请填写问卷"),n.abrupt("return");case 7:return R(!0),i=u()(u()({},e),{},{answers:t,customerId:M,surveyId:A,startTime:q()(e.startTime).valueOf(),submitTime:q()(e.submitTime).valueOf()}),n.next=11,(0,k.ko)(i).then((function(n){"0000"===n.code&&(v.ZP.success("提交成功"),R(!1),setTimeout((function(){window.close()}),200))})).catch((function(n){R(!0)}));case 11:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,I.jsxs)(d.Z,{form:N,className:"".concat(w),scrollToFirstError:!0,style:{height:600,overflow:"auto"},onFinish:X,name:"dynamic_rule",_nk:"".concat(y,"11"),children:[(0,I.jsxs)(f.Z,{_nk:"".concat(y,"21"),children:[(0,I.jsxs)(m.Z,{span:12,style:{paddingLeft:24},_nk:"".concat(y,"31"),children:[(0,I.jsx)(d.Z.Item,{label:"客户姓名",name:"customerName",_nk:"".concat(y,"41"),children:(0,I.jsx)(p.Z,{style:{width:280},placeholder:"请输入",_nk:"".concat(y,"51")})}),(0,I.jsx)(d.Z.Item,{label:"客户年龄：",name:"customerAge",_nk:"".concat(y,"42"),children:(0,I.jsx)(p.Z,{style:{width:280},placeholder:"请输入",_nk:"".concat(y,"52")})}),(0,I.jsx)(d.Z.Item,{label:"记录人：",name:"seatName",labelCol:{flex:"0 0 68px"},_nk:"".concat(y,"43"),children:(0,I.jsx)(p.Z,{style:{width:280},placeholder:"请输入",_nk:"".concat(y,"53")})})]}),(0,I.jsxs)(m.Z,{span:12,style:{paddingLeft:24},_nk:"".concat(y,"32"),children:[(0,I.jsx)(d.Z.Item,{label:"客户账号：",name:"fundAccountId",_nk:"".concat(y,"44"),children:(0,I.jsx)(p.Z,{style:{width:280},placeholder:"请输入",_nk:"".concat(y,"54")})}),(0,I.jsx)(d.Z.Item,{label:"客户电话",name:"customerMobile",_nk:"".concat(y,"45"),children:(0,I.jsx)(p.Z,{style:{width:280},placeholder:"请输入",_nk:"".concat(y,"55")})}),(0,I.jsx)(d.Z.Item,{label:"回答时间",name:"startTime",_nk:"".concat(y,"46"),children:(0,I.jsx)(h.Z,{style:{width:280},showTime:!0,_nk:"".concat(y,"61")})})]})]}),(0,I.jsxs)(f.Z,{className:"que-title",_nk:"".concat(y,"22"),children:[null==T?void 0:T.surveyName,"："]}),(0,I.jsx)(d.Z.Item,{noStyle:!0,name:"answers",_nk:"".concat(y,"47"),children:null==T||null===(n=T.questionViews)||void 0===n?void 0:n.map((function(n,e){return(0,I.jsxs)(f.Z,{style:{width:790},_nk:"".concat(y,"23"),children:[(0,I.jsxs)(f.Z,{className:"vertical-label ".concat(n.required?"pseudo-form-item-requerd":""),_nk:"".concat(y,"24"),children:[e+1,".（",Z.uU[null==n?void 0:n.type],"）",n.content]}),(0,I.jsx)(Z.Ih,{questionItem:n,setQueAnswer:B,nameUnique:e+"",_nk:"".concat(y,"71")})]},n.questionId)}))}),(0,I.jsxs)(f.Z,{justify:"end",_nk:"".concat(y,"25"),children:[(0,I.jsx)(x.Z,{className:"ghost-btn",onClick:W,style:{marginLeft:8},_nk:"".concat(y,"81"),children:"刷新"}),(0,I.jsx)(x.Z,{loading:K,className:"submit-btn",type:"primary",onClick:function(){N.submit()},style:{marginLeft:8},_nk:"".concat(y,"82"),children:"提交"})]})]})}},3518:function(n,e,t){"use strict";t.d(e,{Ih:function(){return g},uU:function(){return h}});var i=t(35118),o=t.n(i),r=t(153),u=t.n(r),s=(t(68046),t(71219),t(76551),t(79062),t(23279),t(16769),t(80348),t(6503),t(25506),t(14748)),l=t(89444),c=t(41114),a=t(37244),d=t(28068),v=t(62365),f=(t(978),t(50107)),m="Ybj1",p=function(n){return n.fill="fill",n.single="single",n.multiple="multiple",n}({}),h={fill:"填空题",single:"单选题",multiple:"多选题"},x={fill:function(n){var e,t=n.value,i=n.onChange,o=n.id,r=n.questionItem;return(0,f.jsx)(s.Z.TextArea,{id:o,placeholder:"请输入",onChange:function(n){i({questionId:r.questionId,type:r.type,questionAnswer:{text:n.target.value}})},value:(null==t||null===(e=t.questionAnswer)||void 0===e?void 0:e.text)||"",style:{height:62,width:758,resize:"none"},_nk:"".concat(m,"11")})},single:function(n){var e,t,i,o,r,u,d=n.value,v=n.onChange,p=n.id,h=n.questionItem,x={questionId:null!==(e=null==d?void 0:d.questionId)&&void 0!==e?e:h.questionId,type:null!==(t=null==d?void 0:d.type)&&void 0!==t?t:h.type,questionAnswer:{optionAnswers:(null==d||null===(i=d.questionAnswer)||void 0===i?void 0:i.optionAnswers)||[]}},g=function(n,e){x.questionAnswer.optionAnswers=[{index:n||"",filling:e||""}],v(x)},w=(null==d||null===(o=d.questionAnswer)||void 0===o?void 0:o.optionAnswers)||[],k=(null===(r=w[0])||void 0===r?void 0:r.index)+""||"";return(0,f.jsx)(l.ZP.Group,{style:{width:"100%"},value:k,id:p,_nk:"".concat(m,"12"),children:(0,f.jsx)(c.Z,{gutter:[16,16],_nk:"".concat(m,"21"),children:null===(u=h.options)||void 0===u?void 0:u.map((function(n,e){var t,i;return(0,f.jsxs)(a.Z,{flex:(null===(t=n.description)||void 0===t?void 0:t.length)>22?"0 1 100%":"0 1 50%",className:"option-column",_nk:"".concat(m,"31"),children:[(0,f.jsx)(l.ZP,{value:e+1+"",onChange:function(n){return g(e+1+"","")},_nk:"".concat(m,"41"),children:n.description}),n.enableFilling&&(0,f.jsx)(s.Z,{maxLength:500,disabled:k!==e+1+"",onChange:function(n){return g(e+1+"",n.target.value)},value:k===e+1+""?null===(i=w[0])||void 0===i?void 0:i.filling:"",className:"option-input",placeholder:"请输入",_nk:"".concat(m,"51")})]},e)}))})})},multiple:function(n){var e,t,i,o,r,l=n.value,v=n.onChange,p=n.id,h=n.questionItem,x=h.maxSelectedOptionCount,g={questionId:null!==(e=null==l?void 0:l.questionId)&&void 0!==e?e:h.questionId,type:null!==(t=null==l?void 0:l.type)&&void 0!==t?t:h.type,questionAnswer:{optionAnswers:(null==l||null===(i=l.questionAnswer)||void 0===i?void 0:i.optionAnswers)||[]}},w=function(n){!0===n.target.checked?g.questionAnswer.optionAnswers.push({index:n.target.value||"",filling:""}):u()(g.questionAnswer.optionAnswers,(function(e){return e.index==n.target.value})),v(g)},k=function(n,e){var t=g.questionAnswer.optionAnswers.find((function(e){return e.index==n}));t&&(t.filling=e),v(g)},j=(null==l||null===(o=l.questionAnswer)||void 0===o?void 0:o.optionAnswers)||[],_=j.map((function(n){return n.index+""}))||[];return(0,f.jsx)(d.Z.Group,{style:{width:"100%"},value:_,id:p,_nk:"".concat(m,"13"),children:(0,f.jsx)(c.Z,{gutter:[16,16],_nk:"".concat(m,"22"),children:null===(r=h.options)||void 0===r?void 0:r.map((function(n,e){var t,i;return(0,f.jsxs)(a.Z,{flex:(null===(t=n.description)||void 0===t?void 0:t.length)>22?"0 1 100%":"0 1 50%",className:"option-column",_nk:"".concat(m,"32"),children:[(0,f.jsx)(d.Z,{value:e+1+"",disabled:_.length>=x&&!_.includes(e+1+""),onChange:w,_nk:"".concat(m,"61"),children:n.description}),n.enableFilling&&(0,f.jsx)(s.Z,{maxLength:500,disabled:!j.find((function(n){return n.index==e+1+""})),onChange:function(n){return k(e+1+"",n.target.value)},value:(null===(i=j.find((function(n){return n.index==e+1+""})))||void 0===i?void 0:i.filling)||"",className:"option-input",placeholder:"请输入",_nk:"".concat(m,"52")})]},e)}))})})}},g=function(n){var e,t,i,r=x[null===(e=n.questionItem)||void 0===e?void 0:e.type];return r?(0,f.jsx)(v.Z.Item,{style:{width:800,paddingLeft:16},name:["answers",n.nameUnique],rules:[{required:(null===(t=n.questionItem)||void 0===t?void 0:t.required)||!1,message:(null===(i=n.questionItem)||void 0===i?void 0:i.type)===p.fill?"请输入":"请选择",validator:function(e,t){var i,o,r,u,s;return null===(i=n.questionItem)||void 0===i||!i.required||null!=t&&null!==(o=t.questionAnswer)&&void 0!==o&&o.optionAnswers&&null!=t&&null!==(r=t.questionAnswer)&&void 0!==r&&null!==(r=r.optionAnswers)&&void 0!==r&&r.length?Promise.resolve():(null===(u=n.questionItem)||void 0===u?void 0:u.type)===p.fill?null!=t&&null!==(s=t.questionAnswer)&&void 0!==s&&s.text?Promise.resolve():Promise.reject("请输入"):Promise.reject("请选择")}}],_nk:"".concat(m,"14"),children:(0,f.jsx)(r,o()(o()({},n),{},{_nk:"".concat(m,"81")}))}):(0,f.jsx)("h1",{_nk:"".concat(m,"71"),children:"没找到"})}},37244:function(n,e,t){"use strict";var i=t(31339);e.Z=i.Z},41114:function(n,e,t){"use strict";var i=t(13768);e.Z=i.Z},20239:function(n,e,t){var i=t(99509),o=t(16512);n.exports=function(n,e,t,r){var u=t.length,s=u,l=!r;if(null==n)return!s;for(n=Object(n);u--;){var c=t[u];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++u<s;){var a=(c=t[u])[0],d=n[a],v=c[1];if(l&&c[2]){if(void 0===d&&!(a in n))return!1}else{var f=new i;if(r)var m=r(d,v,a,n,e,f);if(!(void 0===m?o(v,d,3,r,f):m))return!1}}return!0}},91735:function(n,e,t){var i=t(34944).default,o=t(14887),r=t(97769),u=t(39236),s=t(27742),l=t(14952);n.exports=function(n){return"function"==typeof n?n:null==n?u:"object"==i(n)?s(n)?r(n[0],n[1]):o(n):l(n)}},14887:function(n,e,t){var i=t(20239),o=t(61184),r=t(36128);n.exports=function(n){var e=o(n);return 1==e.length&&e[0][2]?r(e[0][0],e[0][1]):function(t){return t===n||i(t,n,e)}}},97769:function(n,e,t){var i=t(16512),o=t(36531),r=t(48265),u=t(42486),s=t(9510),l=t(36128),c=t(76046);n.exports=function(n,e){return u(n)&&s(e)?l(c(n),e):function(t){var u=o(t,n);return void 0===u&&u===e?r(t,n):i(e,u,3)}}},5028:function(n){n.exports=function(n){return function(e){return null==e?void 0:e[n]}}},36476:function(n,e,t){var i=t(91948);n.exports=function(n){return function(e){return i(e,n)}}},61184:function(n,e,t){var i=t(9510),o=t(31420);n.exports=function(n){for(var e=o(n),t=e.length;t--;){var r=e[t],u=n[r];e[t]=[r,u,i(u)]}return e}},9510:function(n,e,t){var i=t(63169);n.exports=function(n){return n==n&&!i(n)}},36128:function(n){n.exports=function(n,e){return function(t){return null!=t&&(t[n]===e&&(void 0!==e||n in Object(t)))}}},14952:function(n,e,t){var i=t(5028),o=t(36476),r=t(42486),u=t(76046);n.exports=function(n){return r(n)?i(u(n)):o(n)}},153:function(n,e,t){var i=t(91735),o=t(20741);n.exports=function(n,e){var t=[];if(!n||!n.length)return t;var r=-1,u=[],s=n.length;for(e=i(e,3);++r<s;){var l=n[r];e(l,r,n)&&(t.push(l),u.push(r))}return o(n,u),t}}}]);